@startuml
' Class diagram for OS simulation
skinparam classAttributeIconSize 0

package "Kernel" {
  class OSSimulation {
    - OSKernel kernel
    + main(String[] args)
    + init()
  }

  class OSKernel {
    - Scheduler scheduler
    - Dispatcher dispatcher
    - List<Process> processes
    - Queue<Process> readyQueue
    + initProcesses()
    + startKernel()
    + shutdown()
  }

  class Scheduler {
    - int timeQuantum = 3
    - String algorithm = "Priority Based"
    - int cycleCount
    + runCycle()
    + schedule(): Process
    + requeue(Process)
    + addProcess(Process)
  }

  class Dispatcher {
    - int cpuQuantum = 3
    - Process currentProcess
    - List<String> dispatchHistory
    + dispatch(Process)
    + executeTimeUnit()
    + contextSwitch()
    + terminateProcess()
    + logEvent(String)
  }
}

package "Process Model" {
  class Process {
    - int pid
    - String name
    - int priority
    - int totalTime
    - int remainingTime
    - ProcessState state
    - List<SimThread> threads
    + decrementRemaining()
    + isComplete(): boolean
    + setState(ProcessState)
  }

  class SimThread {
    - int tid
    - int parentPid
    - int remainingTime
    - String priority
    + runUnit()
    + isComplete(): boolean
  }

  enum ProcessState {
    NEW
    READY
    RUNNING
    BLOCKED
    TERMINATED
  }
}

' Relationships
OSKernel "1" *-- "1" Scheduler : contains
OSKernel "1" *-- "1" Dispatcher : contains
OSKernel "1" o-- "*" Process : manages
Process "1" *-- "*" SimThread : contains
Scheduler --> Process : "schedule()"
Scheduler ..> Dispatcher : "dispatch(selected)"
Dispatcher --> Process : "execute() / contextSwitch()"

"' Sequence diagram (simplified) - PlantUML format"

== Sequence: scheduling -> dispatch -> execute ==

participant S as "Scheduler"
participant D as "Dispatcher"
participant P as "Process"

S ->> S : runCycle()
S ->> P : schedule() [by priority]
S ->> D : dispatch(process)
D ->> P : executeTimeUnit() [repeat up to cpuQuantum]
alt quantum expired
  D ->> D : contextSwitch()
  D ->> S : requeue(process)
else process complete
  D ->> D : terminateProcess()
  D ->> S : notifyTermination()
end
S ->> S : loop until all terminated

@enduml
